{% extends "base.html" %}
{% block content %}
<div class="container-lg mt-4 mb-4">
  <h2 class="mb-4">All Courses</h2>
  <!-- Search Bar -->
  <div class="mb-3">
    <input type="search" id="courseSearch" class="form-control" placeholder="Search for a course, exam, or stream..." style="max-width:340px;">
  </div>
  <div id="course-groups">
    {% for group in categories %}
      <div class="course-category mb-4" data-category="{{ group.title | replace(' ','-') | lower }}">
        <h5 class="text-primary" style="font-weight:700;">{{ group.title }}</h5>
        <div class="row">
          {% for course in group.courses %}
          <div class="col-12 col-md-6 col-lg-3 mb-4 course-card"
               data-course="{{ course.name | lower }} {{ course.tagline | lower }} {{ group.title | lower }}"
               data-category="{{ group.title | replace(' ','-') | lower }}">
            <a href="{{ url_for('course', course_id=course.id) }}" class="text-decoration-none">
              <div class="card shadow-sm border-0 course-box h-100 text-center" style="transition:transform .14s;">
                <div class="card-body d-flex flex-column justify-content-center align-items-center">
                  <span style="font-size:2rem;">{{ course.icon|default('ðŸ“š') }}</span>
                  <div class="fw-bold mt-2" style="font-size:1.12rem;">{{ course.name }}</div>
                  <div class="text-muted small">{{ course.tagline }}</div>
                  {% if course.badge %}
                    <span class="badge bg-warning text-dark mt-2">{{ course.badge }}</span>
                  {% endif %}
                </div>
              </div>
            </a>
          </div>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  </div>
</div>
<style>
.course-box:hover {
  transform: translateY(-6px) scale(1.038);
  box-shadow: 0 6px 32px #85fcff2b;
  background: #f9feff !important;
}
</style>
<script>
// Search within all course cards but KEEP the group structure
document.addEventListener("DOMContentLoaded", function() {
  document.getElementById('courseSearch').addEventListener('input', function() {
    const val = this.value.trim().toLowerCase();
    let anyShown = false;
    document.querySelectorAll('.course-category').forEach((group) => {
      let groupShown = false;
      group.querySelectorAll('.course-card').forEach(card => {
        const text = card.dataset.course;
        if (val === "" || text.includes(val)) {
          card.style.display = '';
          groupShown = true;
          anyShown = true;
        } else {
          card.style.display = 'none';
        }
      });
      group.style.display = groupShown ? '' : 'none';
    });
    // Optional: Show message if no results
    // document.getElementById('noResults').style.display = anyShown ? 'none' : '';
  });
});
</script>
{% endblock %}