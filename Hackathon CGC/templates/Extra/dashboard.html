{% extends "base.html" %}

{% block content %}
<div class="container-xl">

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - EduTech</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        body {
            background: linear-gradient(135deg, #f5f9ff 0%, #f7f3ff 100%);
            min-height: 100vh;
        }
        .welcome-hero {
            background: linear-gradient(90deg, #56C2FF55 30%, #fff0 100%);
            border-radius: 1.5rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 2rem;
        }
        .dashboard-avatar {
            width: 88px;
            height: 88px;
            border-radius: 50%;
            background: #56C2FF;
            color: #fff;
            font-size: 2.8rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 18px #bdefff99;
            flex-shrink: 0;
        }
        .quick-row a {
            margin: 0 10px 0 0;
            font-weight: 700;
        }
        .dashboard-announcement {
            background: #fff5d1;
            color: #7c5300;
            border-left: 5px solid #ffc107;
            border-radius: 0 .7rem .7rem 0;
            margin: 1rem 0 2.5rem 0;
            padding: 0.9rem 1.5rem;
            font-size: 1.08rem;
        }
        .dashboard-progress {
            background: #ffffffc9;
            border-radius: 1.2rem;
            box-shadow: 0 3px 16px #dedede60;
        }
        .progress-bar {
            background: linear-gradient(90deg, #5e93ff 40%, #62e7f9 100%);
        }
        .dashboard-card {
            border-radius: 1.1rem;
            box-shadow: 0 2px 12px 0 #e8e8e8b3;
            min-height: 180px;
        }
        .activity-box {
            background: #eaf6fa;
            border-radius: 12px;
            padding: 1.3rem 1.7rem;
            box-shadow: 0 0 10px #b9e3ff50;
        }
        .motivation {
            font-size: 1.07rem;
            color: #5552aa;
        }
    </style>
</head>
<body>
    <div class="container-xl">
        <!-- Hero Welcome -->
        <div class="welcome-hero mb-4 mt-4">
            <div class="dashboard-avatar">
                {{ current_user.username[:2] | upper }}
            </div>
            <div>
                <h2>Welcome, {{ current_user.username }}!</h2>
                <div class="text-muted">Letâ€™s make today productive. <span style="font-size:.98rem;">
                  {% if last_login %} Last login: {{ last_login }} {% endif %}
                  </span></div>
                <div class="mt-2 quick-row">
                    <a href="{{ url_for('profile') }}" class="btn btn-outline-primary btn-sm rounded-pill"><i class="bi bi-person"></i> Profile</a>
                    <a href="{{ url_for('quiz', chapter_id=next_quiz_chapter or 1) }}" class="btn btn-outline-warning btn-sm rounded-pill"><i class="bi bi-lightning"></i> Take Quiz</a>
                    <a href="{{ url_for('formulas') }}" class="btn btn-outline-info btn-sm rounded-pill"><i class="bi bi-journal"></i> All Formulas</a>
                    {% if current_user.is_admin %}
                      <a href="{{ url_for('admin_panel') }}" class="btn btn-success btn-sm rounded-pill"><i class="bi bi-gear"></i> Admin Panel</a>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- Announcement Example -->
        {% if announcements %}
        <div class="dashboard-announcement">
            <i class="bi bi-megaphone"></i> <strong>Announcement:</strong> {{ announcements[0].text }}
        </div>
        {% endif %}
        <!-- Dashboard Courses -->
        <h3 class="mb-3">Your Courses</h3>
        <div class="row">
          {% for course in courses %}
            <div class="col-md-4 col-lg-3 mb-4">
              <div class="card dashboard-card">
                <div class="card-body">
                  <h5 class="card-title">{{ course.name }}</h5>
                  <div class="dashboard-progress mb-2 mt-3">
                    <div class="progress" style="height:10px;">
                        <div class="progress-bar" style="width:{{ course.progress|default(45) }}%"></div>
                    </div>
                  </div>
                  <small class="text-muted">{{ course.progress|default(45) }}% complete</small>
                  <div class="text-center mt-3">
                    <a href="{{ url_for('course', course_id=course.id) }}" class="btn btn-primary btn-sm">Go to Course</a>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
        <!-- Recent Activity & Motivation -->
        <div class="row align-items-center mt-4">
          <div class="col-md-7 mb-3">
              <div class="activity-box">
                  <h6 class="mb-2"><i class="bi bi-clock-history"></i> Recent Activity</h6>
                  <ul class="mb-0">
                      {% for item in recent_activity %}
                          <li>{{ item }}</li>
                      {% else %}
                          <li>No recent activity yet. Start learning!</li>
                      {% endfor %}
                  </ul>
              </div>
          </div>
          <div class="col-md-5">
              <div class="motivation text-center mt-4 mt-md-0">
                  <i class="bi bi-stars"></i>
                  <strong>Did you know?</strong><br>
                  {{ motivational_fact or "Learning something daily keeps your mind sharp!" }}
              </div>
          </div>
        </div>
    </div>
</body>
</html>
</div>
{% endblock %}